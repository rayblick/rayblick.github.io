<!DOCTYPE html>
<html>
  <head>>
    <meta charset="utf-8" />
    <meta lang="en" />
    <title>VOL</title>
    <link rel="stylesheet" type="text/css" href="../css/styles.css" />
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css" />
    <link href='https://fonts.googleapis.com/css?family=Ubuntu|Oswald' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="../css/prism.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script>
        function changeImage() {
            var image = document.getElementById('myImage');
            if (image.src.match("asciileaf")) {
                image.src = "../img/hexleaf_crop.png";
            } else {
                image.src = "../img/asciileaf_crop.png";
            }
        }
    </script>
    <script>
        // USED TO EVALUATE WIDTH AND THICKNESS MEASUREMENTS
        // e.g. form dom_object = document.getElementById("frm1");
        // e.g. string_id = thick ---><input id="thick" type="text"/>
        function parse_strings(y){
            // if the dom object looks like 6 1/2
            if(y.length > 1){
                var z = y[1].split('/');
                var v = (parseInt(y[0]) + (parseInt(z[0]) / parseInt(z[1])));
                return v
            }
            else{
                var z = y[0].split('/');
                // parsed dom_object is a fraction like 1/2
                if(z.length > 1){
                    var v = (parseInt(z[0]) / parseInt(z[1]));
                    return v
                }
                // parsed dom object is just an integer like 6
                else{
                    var v = (parseInt(y[0]));
                    return v
                }
            }
        }

        // PARSE LENGTH MEASUREMENTS
        function parse_length(y){
            if(y.length > 1){
                var v = (parseInt(y[0]) + (parseInt(y[1]) / 12));
                return v
            }
            else{
                var v = (parseInt(y[0]));
                return v
            }
        }
        var myArray = []

        function myFunction() {
            // get the dom form object
            var x = document.getElementById("frm1");

            // Extract the values for each measurement
            // Also split each string on white space
            var l = x.len.value.split(" ");
            var w = x.wid.value.split(" ");
            var t = x.thick.value.split(" ");

            // parse the form input boxes
            var len = parse_length(l)
            var wid = parse_strings(w)
            var thick = parse_strings(t)

            // check if length width and thickness fall inside
            // appropriate dimensions

            if(x.boards.value == "AR"){
                var boardtype = 0.0
                $('img#surfboardImage').attr("src","../img/allrounder.png")
            }
            else if (x.boards.value == "HP") {
                var boardtype = -2.155433
                $('img#surfboardImage').attr("src","../img/Highperformance.png")
            }
            else if (x.boards.value == "FHP") {
                var boardtype = -1.275470
                $('img#surfboardImage').attr("src","../img/Friendly high performance.png")
            }
            else if (x.boards.value == "SW") {
                var boardtype = -0.675191
                $('img#surfboardImage').attr("src","../img/Smallwave.png")
            }
            else if (x.boards.value == "FI") {
                var boardtype = 1.014127
                $('img#surfboardImage').attr("src","../img/grovelfish.png")
            }
            // calculate volume
            var volume = -75.197048 + boardtype + 6.390996 * len
                        + 2.605445 * wid
                        + 7.154882 * thick

            var volume = volume.toFixed(3)

            // return the volume to the html tag "demo"
            if(x.len.value != "" && x.wid.value != "" && x.thick.value != ""){
                document.getElementById("demo").innerHTML = volume + ' litres';

                // save each search to an array (gets wiped on page reload)
                myArray.push(x.boards.value + '; length: ' + x.len.value + '; width: ' +
                            x.wid.value + '; thickness: ' + x.thick.value + ' = ' + volume)
                myArrayLength = myArray.length - 1

                // on the second request show the last calculation
                if(myArrayLength >= 1){
                    document.getElementById("last_calc").innerHTML = "Your last calculation: "
                    document.getElementById("myLastCalculation").innerHTML = myArray[myArrayLength-1]
                }
            }
            else{
                document.getElementById("demo").innerHTML = "";
            }
        }
    </script>
    </head>
    <body>
        <div class='container'>
            <div class='main-wrapper'>
                <div class="sidebar">
                    <div class="sidebar-logo">
                        <img id="myImage" onclick="changeImage()" src="../img/hexleaf_crop.png">
                    </div>
                    <div class="sidebar-title">
                        Ray Blick
                    </div>
                    <hr class='sectionbreak'>
                    <div class="sidebar-documentation">
                        <strong>Projects</strong>
                        <br>
                        <div class="sidebar-list-indent">
                            <li><a href="../index.html">Home</a></li>
                            <li><a href="healthapp.html">Health App</a></li>
                            <li><a href="bioapp.html">Bio Video App</a></li>
                            <li><a href="samplinggame.html">Sampling Game</a></li>
                            <li><a href="boardvolume.html">Surfboard Volume</a></li>
                            <li><a href="surfmaps.html">Surf maps</a></li>
                            <li><a href="virtualecologist.html">Virtual Ecologist</a></li>
                        </div>
                    </div>
                </div>
                <div class='title-container'>
                    <h1>Calculate surfboard volume</h1>
                </div>
                <div class='maincontent-wrapper'>
                    <hr class='sectionbreak'>
                    <div class="documentation-wrapper">
                        <div class="documentation-container">
                            <div class="documentation-content">
                                <h4>Surfboard volume</h4>
                                <br>
                                <div class="documentation-content-left-50">
                                    <form id="frm1" method="post">
                                        <p>
                                            <div>
                                                <label>Board type:</label>
                                                <!--<input id="boardtype" list="boards">-->
                                                <select id="boards" onchange="myFunction()">
                                                    <option value="HP">High Performance (HP)</option>
                                                    <option value="FHP">Friendly High Performance (FH)</option>
                                                    <option value="AR">All rounder (AR)</option>
                                                    <option value="SW">Small wave performance (SW)</option>
                                                    <option value="FI">Fish/Grovel (FI)</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label for="id_length">Length:</label>
                                                <input id="len" type="text" maxlength="100"/>
                                            </div>
                                        </p>
                                        <p>
                                            <div>
                                            <label for="id_width">Width:</label>
                                            <input id="wid" type="text" maxlength="100"/>
                                            </div>
                                        </p>
                                        <p>
                                            <div>
                                            <label for="id_thickness">Thickness:</label>
                                            <input id="thick" type="text" maxlength="100"/>
                                            </div>
                                        </p>
                                    </form>

                                    <p>Click "Calculate" to display board volume </p>
                                    <button onclick="myFunction()">Calculate</button>
                                    <p id="demo"></p>
                                    <h4 id="last_calc" style="color: #3366CC"></h4>
                                    <p id="myLastCalculation" style="color: #3366CC"></p>
                                </div>

                                <div class="documentation-content-right-50">
                                    <img id="surfboardImage" src="../img/Highperformance.png" style="height:300px;">
                                </div>
                            </div>
                                <hr class='sectionbreak'>

                                <div class="documentation-content">
                                    <h4>Tests:</h4>
                                        <p>
                                            Formula created using multiple regression. Board type
                                            is coded as a dummy variable. Calculations based on 285 shapes of
                                            33 distinct boards from 7 manufacturers.
                                        </p>
                                        <!-- Trigger the modal with a button -->
                                        <div id="board_data_buttons1">
                                            <button style="width: 220px" type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal3">Dissimilarity between boards</button>
                                            <button style="width: 220px" type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal2">Dissimilarity in board type</button>
                                        </div>
                                        <div id="board_data_buttons2">
                                            <button style="width: 220px" type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">Distribution of board measurements</button>
                                            <a href='../data/board_data' download='data.csv'><button style="width: 220px" type="button" class="btn btn-primary">Download Board Data</button></a>
                                        </div>

                                        <div class='boardvolume-testresults'>
                                            <h4>Tests:</h4>
                                            <p style="font-size: 15px">
                                                Super Fling: Superbrand (Fish)
                                                5'6, 20 1/4", 2 5/8": volume = 32.90
                                                ...My estimate: 32.509 <strong>(- 0.390)</strong><br></p>
                                            <p style="font-size: 15px">
                                                Couch Potato: Lost (Fish)
                                                5'10, 22 1/2", 2 5/8": volume = 40.8
                                                ...My estimate: 40.502 <strong>(- 0.230)</strong><br></p>
                                            <p style="font-size: 15px">
                                                Puffer Five: MR Surfboards (Small wave performance)
                                                6'2, 21 1/4", 2 5/8": volume = 38.4
                                                ...My estimate: 37.686 <strong>(- 0.714)</strong><br></p>
                                            <p style="font-size: 15px">
                                                Magic Door: Rusty Surfboards (All rounder)
                                                6'4, 20 1/2", 2 3/4" volume = 38.1
                                                ...My estimate: 38.367 <strong>(+ 0.267)</strong><br></p>
                                            <p style="font-size: 15px">
                                                DX1 JF: DHD Surfboards (High performance)
                                                6'3, 19 1/2", 2 1/2" volume = 32.38
                                                ...My estimate: 31.285 <strong>(- 1.095)</strong><br></p>
                                        <br>
                                        <div id="myModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                          <div class="modal-dialog modal-lg">
                                            <div class="modal-content">
                                                <div class="modal-body">
                                                    <img src="../img/boardmeasurements.png" class="img-responsive">
                                                </div>
                                            </div>
                                          </div>
                                        </div>

                                        <div id="myModal2" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                          <div class="modal-dialog modal-lg">
                                            <div class="modal-content">
                                                <div class="modal-body">
                                                    <img src="../img/pca_with_ellipses.png" class="img-responsive">
                                                </div>
                                            </div>
                                          </div>
                                        </div>
                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    <script>
        function centerModal() {
            $(this).css('display', 'block');
            var $dialog = $(this).find(".modal-dialog");
            var offset = ($(window).height() - $dialog.height()) / 2;
            // Center modal vertically in window
            $dialog.css("margin-top", offset);
        }
        $('.modal').on('show.bs.modal', centerModal);
        $(window).on("resize", function () {
            $('.modal:visible').each(centerModal);
        });
    </script>
    </body>
</html>
